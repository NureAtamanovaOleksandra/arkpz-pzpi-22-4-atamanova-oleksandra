Харківський університет радіоелектроніки
Факультет комп'ютерних наук
Кафедра програмної інженерії



ЗВІТ
до лабораторної роботи номер 2 з дисципліни
"Аналіз та рефакторинг коду"
на тему: " РОЗРОБКА БАЗИ ДАНИХ ДЛЯ СЕРВЕРНОЇ ЧАСТИНИ ПРОГРАМНОЇ СИСТЕМИ ТА ПРИКЛАДНОГО ПРОГРАМНОГО ІНТЕРФЕЙСУ (API)"




Виконала ст. гр. ПЗПІ-22-4
Атаманова Олександра Петрівна

Перевірив
ст. викладач кафедри ПІ
Сокорчук Ігор Петрович
 


Харків 2024

1 МЕТА

Метою роботи є розробка бази даних для серверної частини та прикладного програмного інтерфейсу для програмної системи управління та автоматизації дистанційних замовлень у магазині світлодіодної продукції.

2 ХІД РОБОТИ

Першим етапом виконання лабораторної роботи стало розроблення UML-діаграми прецедентів для програмної системи управління та автоматизації дистанційних замовлень у магазині світлодіодної продукції. Цю діаграму наведено в Додатку А.
Далі було побудовано ER-діаграму, яку наведено в Додатку Б. 
На основі створеної ER-діаграми було спроектовано та реалізовано базу даних у MongoDB. Діаграма структури бази даних наведено в Додатку В.
Наступним кроком було розроблено REST API з використанням фреймворку Express.
Щоб спростити розробку та тестування, було створено документацію API з використанням Postman. Цю специфікацію наведено в Додатку Г.
Кожен маршрут API був протестований у Postman, а тестова колекція збережена для подальшої роботи. Відеозапис захисту наведено в Додатку Е.
У процесі розробки API були прийняті такі технічні рішення:
а) система організована за багатошаровою архітектурою:
    1)	на клієнтському рівні здійснюється формування та надсилання HTTP-запитів до API;
    2)	серверний рівень реалізований за допомогою Express для обробки цих запитів;
    3)	збереження даних виконується на рівні бази, де використовується MongoDB;
б) Express був обраний як основний фреймворк завдяки:
    1)	легкості у використанні та швидкому налаштуванню;
    2)	гнучкій архітектурі, яка дозволяє створювати модульні додатки;
    3)	можливості інтеграції різноманітних middleware для обробки запитів;
    4)	підтримці сучасних стандартів JavaScript;
    5)	широкій екосистемі, яка надає безліч готових бібліотек і рішень;
в) для роботи з базою даних використовується Mongoose ODM, яка забезпечує:
    1)	інтуїтивні інструменти для створення та налаштування схем;
    2)	вбудовану систему перевірки даних;
    3)	зручність у визначенні та управлінні зв’язками між даними;
    4)	повну підтримку сучасних можливостей JavaScript;
г) валідація даних здійснюється на рівні бази даних за допомогою схем Mongoose, що дозволяє перевіряти дані перед збереженням;
д) MongoDB було обрано для зберігання даних завдяки її:
    1)	можливості працювати зі структурами, які легко адаптуються під зміни;
    2)	швидкому доступу до даних навіть при великому обсязі інформації;
    3)	здатності масштабуватись для підтримки дедалі більших навантажень;
    4)	простому використанню документів, що нагадують формат JSON, для зручності розробки.
Увесь вихідний код проєкту розміщений у репозиторії GitHub, а основні частини коду наведені в Додатку Д.

 
ВИСНОВКИ

Під час виконання лабораторної роботи були розроблені UML діаграма прецедентів та ER діаграма для програмної системи управління та автоматизації дистанційних замовлень у магазині світлодіодної продукції. Це дозволило сформулювати основні вимоги до функціональності та структури даних. На основі цих діаграм була побудована база даних і створена документація API для опису взаємодії між компонентами системи за допомогою Postman.
Серверну частину системи було розроблено за допомогою фреймворку Express, який забезпечує гнучкість і простоту налаштування завдяки своїй легкій структурі та широким можливостям для розширення. Усі розробки виконувались на JavaScript, що дозволяє використовувати сучасні функції мови та знижує складність підтримки коду. Для роботи з базою даних застосовано Mongoose ODM, що пропонує зручні інструменти для управління схемами та валідації даних. Тестування API здійснювалося через Postman.
 
ДОДАТОК А
UML ДІАГРАМА ПРЕЦЕДЕНТІВ

Рисунок А.1 – UML діаграма прецедентів
 
ДОДАТОК Б
ER ДІАГРАМА БАЗИ ДАНИХ

Рисунок Б.1 – ER діаграма бази даних

ДОДАТОК В
ДІАГРАМА СТРУКТУРИ БАЗИ ДАНИХ

Рисунок В.1 – Діаграма структури бази даних
 
ДОДАТОК Г
СПЕЦИФІКАЦІЯ API

1 	{
2 	    "info": {
3 	        "_postman_id": "bb6c353e-5e64-4b11-a3f0-d6eb5a1357a2",
4 	        "name": "OrderManagementSystem",
5 	        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
6 	        "_exporter_id": "40359270"
7 	    },
8 	    "item": [
9 	        {
10 	            "name": "User",
11 	            "item": [
12 	                {
13 	                    "name": "All Users for Admin",
14 	                    "request": {
15 	                        "auth": {
16 	                            "type": "bearer",
17 	                            "bearer": [
18 	                                {
19 	                                    "key": "token",
20 	                                    "value": "{{AUTH_TOKEN}}",
21 	                                    "type": "string"
22 	                                }
23 	                            ]
24 	                        },
25 	                        "method": "GET",
26 	                        "header": [],
27 	                        "url": {
28 	                            "raw": "http://localhost:5000/api/users",
29 	                            "protocol": "http",
30 	                            "host": [
31 	                                "localhost"
32 	                            ],
33 	                            "port": "5000",
34 	                            "path": [
35 	                                "api",
36 	                                "users"
37 	                            ]
38 	                        }
39 	                    },
40 	                    "response": []
41 	                },
42 	                {
43 	                    "name": "User By Id for Admin",
44 	                    "request": {
45 	                        "auth": {
46 	                            "type": "bearer",
47 	                            "bearer": [
48 	                                {
49 	                                    "key": "token",
50 	                                    "value": "{{AUTH_TOKEN}}",
51 	                                    "type": "string"
52 	                                }
53 	                            ]
54 	                        },
55 	                        "method": "GET",
56 	                        "header": [],
57 	                        "url": {
58 	                            "raw": "http://localhost:5000/api/users/67657e81237a56d2487b8367",
59 	                            "protocol": "http",
60 	                            "host": [
61 	                                "localhost"
62 	                            ],
63 	                            "port": "5000",
64 	                            "path": [
65 	                                "api",
66 	                                "users",
67 	                                "67657e81237a56d2487b8367"
68 	                            ]
69 	                        }
70 	                    },
71 	                    "response": []
72 	                },
73 	                {
74 	                    "name": "My account",
75 	                    "request": {
76 	                        "auth": {
77 	                            "type": "bearer",
78 	                            "bearer": [
79 	                                {
80 	                                    "key": "token",
81 	                                    "value": "{{AUTH_TOKEN}}",
82 	                                    "type": "string"
83 	                                }
84 	                            ]
85 	                        },
86 	                        "method": "DELETE",
87 	                        "header": [],
88 	                        "url": {
89 	                            "raw": "http://localhost:5000/api/users/my-account",
90 	                            "protocol": "http",
91 	                            "host": [
92 	                                "localhost"
93 	                            ],
94 	                            "port": "5000",
95 	                            "path": [
96 	                                "api",
97 	                                "users",
98 	                                "my-account"
99 	                            ]
100 	                        }
101 	                    },
102 	                    "response": []
103 	                },
104 	                {
105 	                    "name": "by Admin",
106 	                    "request": {
107 	                        "auth": {
108 	                            "type": "bearer",
109 	                            "bearer": [
110 	                                {
111 	                                    "key": "token",
112 	                                    "value": "{{AUTH_TOKEN}}",
113 	                                    "type": "string"
114 	                                }
115 	                            ]
116 	                        },
117 	                        "method": "DELETE",
118 	                        "header": [],
119 	                        "url": {
120 	                            "raw": "http://localhost:5000/api/users/admin/675c4d5021b692c91160b6be",
121 	                            "protocol": "http",
122 	                            "host": [
123 	                                "localhost"
124 	                            ],
125 	                            "port": "5000",
126 	                            "path": [
127 	                                "api",
128 	                                "users",
129 	                                "admin",
130 	                                "675c4d5021b692c91160b6be"
131 	                            ]
132 	                        }
133 	                    },
134 	                    "response": []
135 	                },
136 	                {
137 	                    "name": "User",
138 	                    "request": {
139 	                        "auth": {
140 	                            "type": "bearer",
141 	                            "bearer": [
142 	                                {
143 	                                    "key": "token",
144 	                                    "value": "{{AUTH_TOKEN}}",
145 	                                    "type": "string"
146 	                                }
147 	                            ]
148 	                        },
149 	                        "method": "PUT",
150 	                        "header": [],
151 	                        "body": {
152 	                            "mode": "raw",
153 	                            "raw": "{\r\n     \"role\": \"admin\"\r\n}",
154 	                            "options": {
155 	                                "raw": {
156 	                                    "language": "json"
157 	                                }
158 	                            }
159 	                        },
160 	                        "url": {
161 	                            "raw": "http://localhost:5000/api/users/675b02bd3a8e4a60ceca2c67",
162 	                            "protocol": "http",
163 	                            "host": [
164 	                                "localhost"
165 	                            ],
166 	                            "port": "5000",
167 	                            "path": [
168 	                                "api",
169 	                                "users",
170 	                                "675b02bd3a8e4a60ceca2c67"
171 	                            ]
172 	                        }
173 	                    },
174 	                    "response": []
175 	                },
176 	                {
177 	                    "name": "Request to Reset Password",
178 	                    "request": {
179 	                        "auth": {
180 	                            "type": "bearer",
181 	                            "bearer": [
182 	                                {
183 	                                    "key": "token",
184 	                                    "value": "{{AUTH_TOKEN}}",
185 	                                    "type": "string"
186 	                                }
187 	                            ]
188 	                        },
189 	                        "method": "POST",
190 	                        "header": [],
191 	                        "body": {
192 	                            "mode": "raw",
193 	                            "raw": "{\r\n    \"email\": \"oleksandra.atamanova@nure.ua\"\r\n}",
194 	                            "options": {
195 	                                "raw": {
196 	                                    "language": "json"
197 	                                }
198 	                            }
199 	                        },
200 	                        "url": {
201 	                            "raw": "http://localhost:5000/api/users/forgot-password",
202 	                            "protocol": "http",
203 	                            "host": [
204 	                                "localhost"
205 	                            ],
206 	                            "port": "5000",
207 	                            "path": [
208 	                                "api",
209 	                                "users",
210 	                                "forgot-password"
211 	                            ]
212 	                        }
213 	                    },
214 	                    "response": []
215 	                },
216 	                {
217 	                    "name": "Update Password",
218 	                    "request": {
219 	                        "auth": {
220 	                            "type": "bearer",
221 	                            "bearer": [
222 	                                {
223 	                                    "key": "token",
224 	                                    "value": "{{AUTH_TOKEN}}",
225 	                                    "type": "string"
226 	                                }
227 	                            ]
228 	                        },
229 	                        "method": "PUT",
230 	                        "header": [],
231 	                        "body": {
232 	                            "mode": "raw",
233 	                            "raw": "{\r\n    \"email\": \"oleksandra.atamanova@nure.ua\",\r\n    \"name\": \"Oleksandra Atamanova\",\r\n    \"newPassword\": \"3128bc8ddefdb374\"\r\n}",
234 	                            "options": {
235 	                                "raw": {
236 	                                    "language": "json"
237 	                                }
238 	                            }
239 	                        },
240 	                        "url": {
241 	                            "raw": "http://localhost:5000/api/users/update-profile",
242 	                            "protocol": "http",
243 	                            "host": [
244 	                                "localhost"
245 	                            ],
246 	                            "port": "5000",
247 	                            "path": [
248 	                                "api",
249 	                                "users",
250 	                                "update-profile"
251 	                            ]
252 	                        }
253 	                    },
254 	                    "response": []
255 	                }
256 	            ]
257 	        },
258 	        {
259 	            "name": "Product",
260 	            "item": [
261 	                {
262 	                    "name": "Products",
263 	                    "request": {
264 	                        "auth": {
265 	                            "type": "bearer",
266 	                            "bearer": [
267 	                                {
268 	                                    "key": "token",
269 	                                    "value": "{{AUTH_TOKEN}}",
270 	                                    "type": "string"
271 	                                }
272 	                            ]
273 	                        },
274 	                        "method": "GET",
275 	                        "header": [],
276 	                        "url": {
277 	                            "raw": "http://localhost:5000/api/products",
278 	                            "protocol": "http",
279 	                            "host": [
280 	                                "localhost"
281 	                            ],
282 	                            "port": "5000",
283 	                            "path": [
284 	                                "api",
285 	                                "products"
286 	                            ]
287 	                        }
288 	                    },
289 	                    "response": []
290 	                },
291 	                {
292 	                    "name": "Product By Id",
293 	                    "request": {
294 	                        "method": "GET",
295 	                        "header": [],
296 	                        "url": {
297 	                            "raw": "http://localhost:5000/api/products/675974e10eb9dbd00ef3784a",
298 	                            "protocol": "http",
299 	                            "host": [
300 	                                "localhost"
301 	                            ],
302 	                            "port": "5000",
303 	                            "path": [
304 	                                "api",
305 	                                "products",
306 	                                "675974e10eb9dbd00ef3784a"
307 	                            ]
308 	                        }
309 	                    },
310 	                    "response": []
311 	                },
312 	                {
313 	                    "name": "Products By Brand",
314 	                    "request": {
315 	                        "method": "GET",
316 	                        "header": [],
317 	                        "url": {
318 	                            "raw": "http://localhost:5000/api/products/brand/Govee",
319 	                            "protocol": "http",
320 	                            "host": [
321 	                                "localhost"
322 	                            ],
323 	                            "port": "5000",
324 	                            "path": [
325 	                                "api",
326 	                                "products",
327 	                                "brand",
328 	                                "Govee"
329 	                            ]
330 	                        }
331 	                    },
332 	                    "response": []
333 	                },
334 	                {
335 	                    "name": "Products By Size",
336 	                    "request": {
337 	                        "method": "GET",
338 	                        "header": [],
339 	                        "url": {
340 	                            "raw": "http://localhost:5000/api/products/size/5",
341 	                            "protocol": "http",
342 	                            "host": [
343 	                                "localhost"
344 	                            ],
345 	                            "port": "5000",
346 	                            "path": [
347 	                                "api",
348 	                                "products",
349 	                                "size",
350 	                                "5"
351 	                            ]
352 	                        }
353 	                    },
354 	                    "response": []
355 	                },
356 	                {
357 	                    "name": "Products By Type",
358 	                    "request": {
359 	                        "method": "GET",
360 	                        "header": [],
361 	                        "url": {
362 	                            "raw": "http://localhost:5000/api/products/type/Lamp",
363 	                            "protocol": "http",
364 	                            "host": [
365 	                                "localhost"
366 	                            ],
367 	                            "port": "5000",
368 	                            "path": [
369 	                                "api",
370 	                                "products",
371 	                                "type",
372 	                                "Lamp"
373 	                            ]
374 	                        }
375 	                    },
376 	                    "response": []
377 	                },
378 	                {
379 	                    "name": "Products By Price",
380 	                    "request": {
381 	                        "method": "GET",
382 	                        "header": [],
383 	                        "url": {
384 	                            "raw": "http://localhost:5000/api/products/price/15/25",
385 	                            "protocol": "http",
386 	                            "host": [
387 	                                "localhost"
388 	                            ],
389 	                            "port": "5000",
390 	                            "path": [
391 	                                "api",
392 	                                "products",
393 	                                "price",
394 	                                "15",
395 	                                "25"
396 	                            ]
397 	                        }
398 	                    },
399 	                    "response": []
400 	                },
401 	                {
402 	                    "name": "Products By Quantity",
403 	                    "request": {
404 	                        "method": "GET",
405 	                        "header": [],
406 	                        "url": {
407 	                            "raw": "http://localhost:5000/api/products/quantity/5/100",
408 	                            "protocol": "http",
409 	                            "host": [
410 	                                "localhost"
411 	                            ],
412 	                            "port": "5000",
413 	                            "path": [
414 	                                "api",
415 	                                "products",
416 	                                "quantity",
417 	                                "5",
418 	                                "100"
419 	                            ]
420 	                        }
421 	                    },
422 	                    "response": []
423 	                },
424 	                {
425 	                    "name": "Product by Admin",
426 	                    "request": {
427 	                        "auth": {
428 	                            "type": "bearer",
429 	                            "bearer": [
430 	                                {
431 	                                    "key": "token",
432 	                                    "value": "{{AUTH_TOKEN}}",
433 	                                    "type": "string"
434 	                                }
435 	                            ]
436 	                        },
437 	                        "method": "POST",
438 	                        "header": [],
439 	                        "body": {
440 	                            "mode": "raw",
441 	                            "raw": "{\r\n  \"name\": \"TESTPRODUCT\",\r\n  \"description\": \"description3\",\r\n  \"brand\": \"brand3\",\r\n  \"size\": \"3\",\r\n  \"type\": \"Type3\",\r\n  \"price\": 30,\r\n  \"quantity\": 15\r\n}",
442 	                            "options": {
443 	                                "raw": {
444 	                                    "language": "json"
445 	                                }
446 	                            }
447 	                        },
448 	                        "url": {
449 	                            "raw": "http://localhost:5000/api/products",
450 	                            "protocol": "http",
451 	                            "host": [
452 	                                "localhost"
453 	                            ],
454 	                            "port": "5000",
455 	                            "path": [
456 	                                "api",
457 	                                "products"
458 	                            ]
459 	                        }
460 	                    },
461 	                    "response": []
462 	                },
463 	                {
464 	                    "name": "Product ny Admin",
465 	                    "request": {
466 	                        "auth": {
467 	                            "type": "bearer",
468 	                            "bearer": [
469 	                                {
470 	                                    "key": "token",
471 	                                    "value": "{{AUTH_TOKEN}}",
472 	                                    "type": "string"
473 	                                }
474 	                            ]
475 	                        },
476 	                        "method": "DELETE",
477 	                        "header": [],
478 	                        "url": {
479 	                            "raw": "http://localhost:5000/api/products/67699fdb3cc825a0206c5ef7",
480 	                            "protocol": "http",
481 	                            "host": [
482 	                                "localhost"
483 	                            ],
484 	                            "port": "5000",
485 	                            "path": [
486 	                                "api",
487 	                                "products",
488 	                                "67699fdb3cc825a0206c5ef7"
489 	                            ]
490 	                        }
491 	                    },
492 	                    "response": []
493 	                },
494 	                {
495 	                    "name": "Product by Admin",
496 	                    "request": {
497 	                        "auth": {
498 	                            "type": "bearer",
499 	                            "bearer": [
500 	                                {
501 	                                    "key": "token",
502 	                                    "value": "{{AUTH_TOKEN}}",
503 	                                    "type": "string"
504 	                                }
505 	                            ]
506 	                        },
507 	                        "method": "PUT",
508 	                        "header": [],
509 	                        "body": {
510 	                            "mode": "raw",
511 	                            "raw": "{\r\n    \"name\": \"LED Lamp Gove\",\r\n    \"brand\": \"Govee\"\r\n}",
512 	                            "options": {
513 	                                "raw": {
514 	                                    "language": "json"
515 	                                }
516 	                            }
517 	                        },
518 	                        "url": {
519 	                            "raw": "http://localhost:5000/api/products/67699fdb3cc825a0206c5ef7",
520 	                            "protocol": "http",
521 	                            "host": [
522 	                                "localhost"
523 	                            ],
524 	                            "port": "5000",
525 	                            "path": [
526 	                                "api",
527 	                                "products",
528 	                                "67699fdb3cc825a0206c5ef7"
529 	                            ]
530 	                        }
531 	                    },
532 	                    "response": []
533 	                }
534 	            ]
535 	        },
536 	        {
537 	            "name": "Payment",
538 	            "item": [
539 	                {
540 	                    "name": "All Payments for Admin",
541 	                    "request": {
542 	                        "auth": {
543 	                            "type": "bearer",
544 	                            "bearer": [
545 	                                {
546 	                                    "key": "token",
547 	                                    "value": "{{AUTH_TOKEN}}",
548 	                                    "type": "string"
549 	                                }
550 	                            ]
551 	                        },
552 	                        "method": "GET",
553 	                        "header": [],
554 	                        "url": {
555 	                            "raw": "http://localhost:5000/api/payments",
556 	                            "protocol": "http",
557 	                            "host": [
558 	                                "localhost"
559 	                            ],
560 	                            "port": "5000",
561 	                            "path": [
562 	                                "api",
563 	                                "payments"
564 	                            ]
565 	                        }
566 	                    },
567 	                    "response": []
568 	                },
569 	                {
570 	                    "name": "My payments",
571 	                    "request": {
572 	                        "auth": {
573 	                            "type": "bearer",
574 	                            "bearer": [
575 	                                {
576 	                                    "key": "token",
577 	                                    "value": "{{AUTH_TOKEN}}",
578 	                                    "type": "string"
579 	                                }
580 	                            ]
581 	                        },
582 	                        "method": "GET",
583 	                        "header": [],
584 	                        "url": {
585 	                            "raw": "http://localhost:5000/api/payments/my-payments",
586 	                            "protocol": "http",
587 	                            "host": [
588 	                                "localhost"
589 	                            ],
590 	                            "port": "5000",
591 	                            "path": [
592 	                                "api",
593 	                                "payments",
594 	                                "my-payments"
595 	                            ]
596 	                        }
597 	                    },
598 	                    "response": []
599 	                },
600 	                {
601 	                    "name": "Payment By Order",
602 	                    "request": {
603 	                        "auth": {
604 	                            "type": "bearer",
605 	                            "bearer": [
606 	                                {
607 	                                    "key": "token",
608 	                                    "value": "{{AUTH_TOKEN}}",
609 	                                    "type": "string"
610 	                                }
611 	                            ]
612 	                        },
613 	                        "method": "GET",
614 	                        "header": [],
615 	                        "url": {
616 	                            "raw": "http://localhost:5000/api/payments/order/675c0bec19193f76a59aa804",
617 	                            "protocol": "http",
618 	                            "host": [
619 	                                "localhost"
620 	                            ],
621 	                            "port": "5000",
622 	                            "path": [
623 	                                "api",
624 	                                "payments",
625 	                                "order",
626 	                                "675c0bec19193f76a59aa804"
627 	                            ]
628 	                        }
629 	                    },
630 	                    "response": []
631 	                },
632 	                {
633 	                    "name": "Payment By User",
634 	                    "request": {
635 	                        "auth": {
636 	                            "type": "bearer",
637 	                            "bearer": [
638 	                                {
639 	                                    "key": "token",
640 	                                    "value": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY3NjZkMDQ3OGVhYzQ4OWZhNTY3YjVkZiIsImlhdCI6MTczNDk3NDg1MiwiZXhwIjoxNzM1MDYxMjUyfQ.YrjMuh_hpWM2MJFl4CXhpNzgukIo47ixlWgon7o3fSc",
641 	                                    "type": "string"
642 	                                }
643 	                            ]
644 	                        },
645 	                        "method": "GET",
646 	                        "header": [],
647 	                        "url": {
648 	                            "raw": "http://localhost:5000/api/payments/user/675bff6c19193f76a59aa7dd",
649 	                            "protocol": "http",
650 	                            "host": [
651 	                                "localhost"
652 	                            ],
653 	                            "port": "5000",
654 	                            "path": [
655 	                                "api",
656 	                                "payments",
657 	                                "user",
658 	                                "675bff6c19193f76a59aa7dd"
659 	                            ]
660 	                        }
661 	                    },
662 	                    "response": []
663 	                },
664 	                {
665 	                    "name": "Payment By Status",
666 	                    "request": {
667 	                        "auth": {
668 	                            "type": "bearer",
669 	                            "bearer": [
670 	                                {
671 	                                    "key": "token",
672 	                                    "value": "{{AUTH_TOKEN}}",
673 	                                    "type": "string"
674 	                                }
675 	                            ]
676 	                        },
677 	                        "method": "GET",
678 	                        "header": [],
679 	                        "url": {
680 	                            "raw": "http://localhost:5000/api/payments/status/failed",
681 	                            "protocol": "http",
682 	                            "host": [
683 	                                "localhost"
684 	                            ],
685 	                            "port": "5000",
686 	                            "path": [
687 	                                "api",
688 	                                "payments",
689 	                                "status",
690 	                                "failed"
691 	                            ]
692 	                        }
693 	                    },
694 	                    "response": []
695 	                },
696 	                {
697 	                    "name": "Payment",
698 	                    "request": {
699 	                        "auth": {
700 	                            "type": "bearer",
701 	                            "bearer": [
702 	                                {
703 	                                    "key": "token",
704 	                                    "value": "{{AUTH_TOKEN}}",
705 	                                    "type": "string"
706 	                                }
707 	                            ]
708 	                        },
709 	                        "method": "POST",
710 	                        "header": [],
711 	                        "body": {
712 	                            "mode": "raw",
713 	                            "raw": "{\r\n  \"order_id\": \"675c0bec19193f76a59aa804\",\r\n  \"user_id\": \"67657e81237a56d2487b8367\",\r\n  \"product_id\": \"675974e10eb9dbd00ef3784a\",\r\n  \"amount\": -15000.00,\r\n  \"status\": \"completed\"\r\n}",
714 	                            "options": {
715 	                                "raw": {
716 	                                    "language": "json"
717 	                                }
718 	                            }
719 	                        },
720 	                        "url": {
721 	                            "raw": "http://localhost:5000/api/payments",
722 	                            "protocol": "http",
723 	                            "host": [
724 	                                "localhost"
725 	                            ],
726 	                            "port": "5000",
727 	                            "path": [
728 	                                "api",
729 	                                "payments"
730 	                            ]
731 	                        }
732 	                    },
733 	                    "response": []
734 	                },
735 	                {
736 	                    "name": "Payment",
737 	                    "request": {
738 	                        "auth": {
739 	                            "type": "bearer",
740 	                            "bearer": [
741 	                                {
742 	                                    "key": "token",
743 	                                    "value": "{{AUTH_TOKEN}}",
744 	                                    "type": "string"
745 	                                }
746 	                            ]
747 	                        },
748 	                        "method": "DELETE",
749 	                        "header": [],
750 	                        "body": {
751 	                            "mode": "raw",
752 	                            "raw": "",
753 	                            "options": {
754 	                                "raw": {
755 	                                    "language": "json"
756 	                                }
757 	                            }
758 	                        },
759 	                        "url": {
760 	                            "raw": "http://localhost:5000/api/payments/676583e9d6bdea181044d1bd",
761 	                            "protocol": "http",
762 	                            "host": [
763 	                                "localhost"
764 	                            ],
765 	                            "port": "5000",
766 	                            "path": [
767 	                                "api",
768 	                                "payments",
769 	                                "676583e9d6bdea181044d1bd"
770 	                            ]
771 	                        }
772 	                    },
773 	                    "response": []
774 	                }
775 	            ]
776 	        },
777 	        {
778 	            "name": "Order",
779 	            "item": [
780 	                {
781 	                    "name": "All Orders for Admin",
782 	                    "request": {
783 	                        "auth": {
784 	                            "type": "bearer",
785 	                            "bearer": [
786 	                                {
787 	                                    "key": "token",
788 	                                    "value": "{{AUTH_TOKEN}}",
789 	                                    "type": "string"
790 	                                }
791 	                            ]
792 	                        },
793 	                        "method": "GET",
794 	                        "header": [],
795 	                        "url": {
796 	                            "raw": "http://localhost:5000/api/orders",
797 	                            "protocol": "http",
798 	                            "host": [
799 	                                "localhost"
800 	                            ],
801 	                            "port": "5000",
802 	                            "path": [
803 	                                "api",
804 	                                "orders"
805 	                            ]
806 	                        }
807 	                    },
808 	                    "response": []
809 	                },
810 	                {
811 	                    "name": "My orders",
812 	                    "request": {
813 	                        "auth": {
814 	                            "type": "bearer",
815 	                            "bearer": [
816 	                                {
817 	                                    "key": "token",
818 	                                    "value": "{{AUTH_TOKEN}}",
819 	                                    "type": "string"
820 	                                }
821 	                            ]
822 	                        },
823 	                        "method": "GET",
824 	                        "header": [],
825 	                        "url": {
826 	                            "raw": "http://localhost:5000/api/orders/my-orders",
827 	                            "protocol": "http",
828 	                            "host": [
829 	                                "localhost"
830 	                            ],
831 	                            "port": "5000",
832 	                            "path": [
833 	                                "api",
834 	                                "orders",
835 	                                "my-orders"
836 	                            ]
837 	                        }
838 	                    },
839 	                    "response": []
840 	                },
841 	                {
842 	                    "name": "Order By Id",
843 	                    "request": {
844 	                        "auth": {
845 	                            "type": "bearer",
846 	                            "bearer": [
847 	                                {
848 	                                    "key": "token",
849 	                                    "value": "{{AUTH_TOKEN}}",
850 	                                    "type": "string"
851 	                                }
852 	                            ]
853 	                        },
854 	                        "method": "GET",
855 	                        "header": [],
856 	                        "url": {
857 	                            "raw": "http://localhost:5000/api/orders/675c0bec19193f76a59aa804",
858 	                            "protocol": "http",
859 	                            "host": [
860 	                                "localhost"
861 	                            ],
862 	                            "port": "5000",
863 	                            "path": [
864 	                                "api",
865 	                                "orders",
866 	                                "675c0bec19193f76a59aa804"
867 	                            ]
868 	                        }
869 	                    },
870 	                    "response": []
871 	                },
872 	                {
873 	                    "name": "Orders By User",
874 	                    "request": {
875 	                        "auth": {
876 	                            "type": "bearer",
877 	                            "bearer": [
878 	                                {
879 	                                    "key": "token",
880 	                                    "value": "{{AUTH_TOKEN}}",
881 	                                    "type": "string"
882 	                                }
883 	                            ]
884 	                        },
885 	                        "method": "GET",
886 	                        "header": [],
887 	                        "url": {
888 	                            "raw": "http://localhost:5000/api/orders/user/675bff6c19193f76a59aa7dd",
889 	                            "protocol": "http",
890 	                            "host": [
891 	                                "localhost"
892 	                            ],
893 	                            "port": "5000",
894 	                            "path": [
895 	                                "api",
896 	                                "orders",
897 	                                "user",
898 	                                "675bff6c19193f76a59aa7dd"
899 	                            ]
900 	                        }
901 	                    },
902 	                    "response": []
903 	                },
904 	                {
905 	                    "name": "Orders By Status",
906 	                    "request": {
907 	                        "auth": {
908 	                            "type": "bearer",
909 	                            "bearer": [
910 	                                {
911 	                                    "key": "token",
912 	                                    "value": "{{AUTH_TOKEN}}",
913 	                                    "type": "string"
914 	                                }
915 	                            ]
916 	                        },
917 	                        "method": "GET",
918 	                        "header": [],
919 	                        "url": {
920 	                            "raw": "http://localhost:5000/api/orders/status/processing",
921 	                            "protocol": "http",
922 	                            "host": [
923 	                                "localhost"
924 	                            ],
925 	                            "port": "5000",
926 	                            "path": [
927 	                                "api",
928 	                                "orders",
929 	                                "status",
930 	                                "processing"
931 	                            ]
932 	                        }
933 	                    },
934 	                    "response": []
935 	                },
936 	                {
937 	                    "name": "Orders By Date",
938 	                    "request": {
939 	                        "auth": {
940 	                            "type": "bearer",
941 	                            "bearer": [
942 	                                {
943 	                                    "key": "token",
944 	                                    "value": "{{AUTH_TOKEN}}",
945 	                                    "type": "string"
946 	                                }
947 	                            ]
948 	                        },
949 	                        "method": "GET",
950 	                        "header": [],
951 	                        "url": {
952 	                            "raw": "http://localhost:5000/api/orders/date/2024-12-10/2024-12-14",
953 	                            "protocol": "http",
954 	                            "host": [
955 	                                "localhost"
956 	                            ],
957 	                            "port": "5000",
958 	                            "path": [
959 	                                "api",
960 	                                "orders",
961 	                                "date",
962 	                                "2024-12-10",
963 	                                "2024-12-14"
964 	                            ]
965 	                        }
966 	                    },
967 	                    "response": []
968 	                },
969 	                {
970 	                    "name": "Order",
971 	                    "request": {
972 	                        "auth": {
973 	                            "type": "bearer",
974 	                            "bearer": [
975 	                                {
976 	                                    "key": "token",
977 	                                    "value": "{{AUTH_TOKEN}}",
978 	                                    "type": "string"
979 	                                }
980 	                            ]
981 	                        },
982 	                        "method": "POST",
983 	                        "header": [],
984 	                        "body": {
985 	                            "mode": "raw",
986 	                            "raw": "{\r\n  \"user_id\": \"67657e81237a56d2487b8367\",\r\n  \"total_price\": 15.00,\r\n  \"status\": \"ready\"\r\n}",
987 	                            "options": {
988 	                                "raw": {
989 	                                    "language": "json"
990 	                                }
991 	                            }
992 	                        },
993 	                        "url": {
994 	                            "raw": "http://localhost:5000/api/orders",
995 	                            "protocol": "http",
996 	                            "host": [
997 	                                "localhost"
998 	                            ],
999 	                            "port": "5000",
1000 	                            "path": [
1001 	                                "api",
1002 	                                "orders"
1003 	                            ]
1004 	                        }
1005 	                    },
1006 	                    "response": []
1007 	                },
1008 	                {
1009 	                    "name": "Order for Admin",
1010 	                    "request": {
1011 	                        "auth": {
1012 	                            "type": "bearer",
1013 	                            "bearer": [
1014 	                                {
1015 	                                    "key": "token",
1016 	                                    "value": "{{AUTH_TOKEN}}",
1017 	                                    "type": "string"
1018 	                                }
1019 	                            ]
1020 	                        },
1021 	                        "method": "DELETE",
1022 	                        "header": [],
1023 	                        "url": {
1024 	                            "raw": "http://localhost:5000/api/orders/67658676d6bdea181044d1e2",
1025 	                            "protocol": "http",
1026 	                            "host": [
1027 	                                "localhost"
1028 	                            ],
1029 	                            "port": "5000",
1030 	                            "path": [
1031 	                                "api",
1032 	                                "orders",
1033 	                                "67658676d6bdea181044d1e2"
1034 	                            ]
1035 	                        }
1036 	                    },
1037 	                    "response": []
1038 	                }
1039 	            ]
1040 	        },
1041 	        {
1042 	            "name": "OrderItem",
1043 	            "item": [
1044 	                {
1045 	                    "name": "All OrderItems for Admin",
1046 	                    "request": {
1047 	                        "auth": {
1048 	                            "type": "bearer",
1049 	                            "bearer": [
1050 	                                {
1051 	                                    "key": "token",
1052 	                                    "value": "{{AUTH_TOKEN}}",
1053 	                                    "type": "string"
1054 	                                }
1055 	                            ]
1056 	                        },
1057 	                        "method": "GET",
1058 	                        "header": [],
1059 	                        "url": {
1060 	                            "raw": "http://localhost:5000/api/orderitems",
1061 	                            "protocol": "http",
1062 	                            "host": [
1063 	                                "localhost"
1064 	                            ],
1065 	                            "port": "5000",
1066 	                            "path": [
1067 	                                "api",
1068 	                                "orderitems"
1069 	                            ]
1070 	                        }
1071 	                    },
1072 	                    "response": []
1073 	                },
1074 	                {
1075 	                    "name": "My OrderItems",
1076 	                    "request": {
1077 	                        "auth": {
1078 	                            "type": "bearer",
1079 	                            "bearer": [
1080 	                                {
1081 	                                    "key": "token",
1082 	                                    "value": "{{AUTH_TOKEN}}",
1083 	                                    "type": "string"
1084 	                                }
1085 	                            ]
1086 	                        },
1087 	                        "method": "GET",
1088 	                        "header": [],
1089 	                        "url": {
1090 	                            "raw": "http://localhost:5000/api/orderitems/my-order-items",
1091 	                            "protocol": "http",
1092 	                            "host": [
1093 	                                "localhost"
1094 	                            ],
1095 	                            "port": "5000",
1096 	                            "path": [
1097 	                                "api",
1098 	                                "orderitems",
1099 	                                "my-order-items"
1100 	                            ]
1101 	                        }
1102 	                    },
1103 	                    "response": []
1104 	                },
1105 	                {
1106 	                    "name": "OrderItem By Id",
1107 	                    "request": {
1108 	                        "auth": {
1109 	                            "type": "bearer",
1110 	                            "bearer": [
1111 	                                {
1112 	                                    "key": "token",
1113 	                                    "value": "{{AUTH_TOKEN}}",
1114 	                                    "type": "string"
1115 	                                }
1116 	                            ]
1117 	                        },
1118 	                        "method": "GET",
1119 	                        "header": [],
1120 	                        "url": {
1121 	                            "raw": "http://localhost:5000/api/orderitems/order/675c0bec19193f76a59aa804",
1122 	                            "protocol": "http",
1123 	                            "host": [
1124 	                                "localhost"
1125 	                            ],
1126 	                            "port": "5000",
1127 	                            "path": [
1128 	                                "api",
1129 	                                "orderitems",
1130 	                                "order",
1131 	                                "675c0bec19193f76a59aa804"
1132 	                            ]
1133 	                        }
1134 	                    },
1135 	                    "response": []
1136 	                },
1137 	                {
1138 	                    "name": "OrderItem by Product",
1139 	                    "request": {
1140 	                        "auth": {
1141 	                            "type": "bearer",
1142 	                            "bearer": [
1143 	                                {
1144 	                                    "key": "token",
1145 	                                    "value": "{{AUTH_TOKEN}}",
1146 	                                    "type": "string"
1147 	                                }
1148 	                            ]
1149 	                        },
1150 	                        "method": "GET",
1151 	                        "header": [],
1152 	                        "url": {
1153 	                            "raw": "http://localhost:5000/api/orderitems/product/675974e10eb9dbd00ef3784a",
1154 	                            "protocol": "http",
1155 	                            "host": [
1156 	                                "localhost"
1157 	                            ],
1158 	                            "port": "5000",
1159 	                            "path": [
1160 	                                "api",
1161 	                                "orderitems",
1162 	                                "product",
1163 	                                "675974e10eb9dbd00ef3784a"
1164 	                            ]
1165 	                        }
1166 	                    },
1167 	                    "response": []
1168 	                },
1169 	                {
1170 	                    "name": "OrderItem By Quantity",
1171 	                    "request": {
1172 	                        "auth": {
1173 	                            "type": "bearer",
1174 	                            "bearer": [
1175 	                                {
1176 	                                    "key": "token",
1177 	                                    "value": "{{AUTH_TOKEN}}",
1178 	                                    "type": "string"
1179 	                                }
1180 	                            ]
1181 	                        },
1182 	                        "method": "GET",
1183 	                        "header": [],
1184 	                        "url": {
1185 	                            "raw": "http://localhost:5000/api/orderitems/quantity/1/5",
1186 	                            "protocol": "http",
1187 	                            "host": [
1188 	                                "localhost"
1189 	                            ],
1190 	                            "port": "5000",
1191 	                            "path": [
1192 	                                "api",
1193 	                                "orderitems",
1194 	                                "quantity",
1195 	                                "1",
1196 	                                "5"
1197 	                            ]
1198 	                        }
1199 	                    },
1200 	                    "response": []
1201 	                },
1202 	                {
1203 	                    "name": "OrderItem",
1204 	                    "request": {
1205 	                        "auth": {
1206 	                            "type": "bearer",
1207 	                            "bearer": [
1208 	                                {
1209 	                                    "key": "token",
1210 	                                    "value": "{{AUTH_TOKEN}}",
1211 	                                    "type": "string"
1212 	                                }
1213 	                            ]
1214 	                        },
1215 	                        "method": "POST",
1216 	                        "header": [],
1217 	                        "body": {
1218 	                            "mode": "raw",
1219 	                            "raw": "{\r\n  \"order_id\": \"675c0bec19193f76a59aa804\",\r\n  \"product_id\": \"675974e10eb9dbd00ef3784a\",\r\n  \"user_id\": \"67657e81237a56d2487b8367і\",\r\n  \"quantity\": 220,\r\n  \"price_per_item\": -50.00\r\n}",
1220 	                            "options": {
1221 	                                "raw": {
1222 	                                    "language": "json"
1223 	                                }
1224 	                            }
1225 	                        },
1226 	                        "url": {
1227 	                            "raw": "http://localhost:5000/api/orderitems",
1228 	                            "protocol": "http",
1229 	                            "host": [
1230 	                                "localhost"
1231 	                            ],
1232 	                            "port": "5000",
1233 	                            "path": [
1234 	                                "api",
1235 	                                "orderitems"
1236 	                            ]
1237 	                        }
1238 	                    },
1239 	                    "response": []
1240 	                },
1241 	                {
1242 	                    "name": "OrderItem for Admin",
1243 	                    "request": {
1244 	                        "auth": {
1245 	                            "type": "bearer",
1246 	                            "bearer": [
1247 	                                {
1248 	                                    "key": "token",
1249 	                                    "value": "{{AUTH_TOKEN}}",
1250 	                                    "type": "string"
1251 	                                }
1252 	                            ]
1253 	                        },
1254 	                        "method": "DELETE",
1255 	                        "header": [],
1256 	                        "url": {
1257 	                            "raw": "http://localhost:5000/api/orderitems/676587c1588c6a14c3f32500",
1258 	                            "protocol": "http",
1259 	                            "host": [
1260 	                                "localhost"
1261 	                            ],
1262 	                            "port": "5000",
1263 	                            "path": [
1264 	                                "api",
1265 	                                "orderitems",
1266 	                                "676587c1588c6a14c3f32500"
1267 	                            ]
1268 	                        }
1269 	                    },
1270 	                    "response": []
1271 	                },
1272 	                {
1273 	                    "name": "Popular Product By Orders",
1274 	                    "request": {
1275 	                        "auth": {
1276 	                            "type": "bearer",
1277 	                            "bearer": [
1278 	                                {
1279 	                                    "key": "token",
1280 	                                    "value": "{{AUTH_TOKEN}}",
1281 	                                    "type": "string"
1282 	                                }
1283 	                            ]
1284 	                        },
1285 	                        "method": "GET",
1286 	                        "header": [],
1287 	                        "url": {
1288 	                            "raw": "http://localhost:5000/api/orderitems/popular/2024-12-10/2024-12-15",
1289 	                            "protocol": "http",
1290 	                            "host": [
1291 	                                "localhost"
1292 	                            ],
1293 	                            "port": "5000",
1294 	                            "path": [
1295 	                                "api",
1296 	                                "orderitems",
1297 	                                "popular",
1298 	                                "2024-12-10",
1299 	                                "2024-12-15"
1300 	                            ]
1301 	                        }
1302 	                    },
1303 	                    "response": []
1304 	                }
1305 	            ]
1306 	        },
1307 	        {
1308 	            "name": "Auth",
1309 	            "item": [
1310 	                {
1311 	                    "name": "Register",
1312 	                    "request": {
1313 	                        "method": "POST",
1314 	                        "header": [],
1315 	                        "body": {
1316 	                            "mode": "raw",
1317 	                            "raw": "{\r\n    \"role\": \"user\",\r\n    \"name\": \"testResAccount\",\r\n    \"email\": \"try@resemail.com\",\r\n    \"password\": \"testpassword\"\r\n}",
1318 	                            "options": {
1319 	                                "raw": {
1320 	                                    "language": "json"
1321 	                                }
1322 	                            }
1323 	                        },
1324 	                        "url": {
1325 	                            "raw": "http://localhost:5000/api/auth/register",
1326 	                            "protocol": "http",
1327 	                            "host": [
1328 	                                "localhost"
1329 	                            ],
1330 	                            "port": "5000",
1331 	                            "path": [
1332 	                                "api",
1333 	                                "auth",
1334 	                                "register"
1335 	                            ]
1336 	                        }
1337 	                    },
1338 	                    "response": []
1339 	                },
1340 	                {
1341 	                    "name": "Login",
1342 	                    "request": {
1343 	                        "auth": {
1344 	                            "type": "bearer",
1345 	                            "bearer": [
1346 	                                {
1347 	                                    "key": "token",
1348 	                                    "value": "{{AUTH_TOKEN}}",
1349 	                                    "type": "string"
1350 	                                }
1351 	                            ]
1352 	                        },
1353 	                        "method": "POST",
1354 	                        "header": [],
1355 	                        "body": {
1356 	                            "mode": "raw",
1357 	                            "raw": "{\r\n    \"email\": \"oleksandra.atamanova@nure.ua\",\r\n    \"password\": \"3128bc8ddefdb374\"\r\n}",
1358 	                            "options": {
1359 	                                "raw": {
1360 	                                    "language": "json"
1361 	                                }
1362 	                            }
1363 	                        },
1364 	                        "url": {
1365 	                            "raw": "http://localhost:5000/api/auth/login",
1366 	                            "protocol": "http",
1367 	                            "host": [
1368 	                                "localhost"
1369 	                            ],
1370 	                            "port": "5000",
1371 	                            "path": [
1372 	                                "api",
1373 	                                "auth",
1374 	                                "login"
1375 	                            ]
1376 	                        }
1377 	                    },
1378 	                    "response": []
1379 	                }
1380 	            ]
1381 	        },
1382 	        {
1383 	            "name": "iot",
1384 	            "item": [
1385 	                {
1386 	                    "name": "Status",
1387 	                    "request": {
1388 	                        "auth": {
1389 	                            "type": "bearer",
1390 	                            "bearer": [
1391 	                                {
1392 	                                    "key": "token",
1393 	                                    "value": "{{AUTH_TOKEN}}",
1394 	                                    "type": "string"
1395 	                                }
1396 	                            ]
1397 	                        },
1398 	                        "method": "GET",
1399 	                        "header": [],
1400 	                        "url": {
1401 	                            "raw": "http://localhost:5000/api/iot/status",
1402 	                            "protocol": "http",
1403 	                            "host": [
1404 	                                "localhost"
1405 	                            ],
1406 	                            "port": "5000",
1407 	                            "path": [
1408 	                                "api",
1409 	                                "iot",
1410 	                                "status"
1411 	                            ]
1412 	                        }
1413 	                    },
1414 	                    "response": []
1415 	                },
1416 	                {
1417 	                    "name": "Statistics",
1418 	                    "request": {
1419 	                        "auth": {
1420 	                            "type": "bearer",
1421 	                            "bearer": [
1422 	                                {
1423 	                                    "key": "token",
1424 	                                    "value": "{{AUTH_TOKEN}}",
1425 	                                    "type": "string"
1426 	                                }
1427 	                            ]
1428 	                        },
1429 	                        "method": "GET",
1430 	                        "header": [],
1431 	                        "url": {
1432 	                            "raw": "http://localhost:5000/api/iot/statistics",
1433 	                            "protocol": "http",
1434 	                            "host": [
1435 	                                "localhost"
1436 	                            ],
1437 	                            "port": "5000",
1438 	                            "path": [
1439 	                                "api",
1440 	                                "iot",
1441 	                                "statistics"
1442 	                            ]
1443 	                        }
1444 	                    },
1445 	                    "response": []
1446 	                }
1447 	            ]
1448 	        }
1449 	    ],
1450 	    "event": [
1451 	        {
1452 	            "listen": "prerequest",
1453 	            "script": {
1454 	                "type": "text/javascript",
1455 	                "packages": {},
1456 	                "exec": [
1457 	                    "pm.sendRequest({\r",
1458 	                    "    url: 'http://localhost:5000/api/auth/login',\r",
1459 	                    "    method: 'POST',\r",
1460 	                    "    header: {\r",
1461 	                    "        'content-type': 'application/json; charset=utf-8'\r",
1462 	                    "    },\r",
1463 	                    "    body: {\r",
1464 	                    "        mode: 'raw',\r",
1465 	                    "        raw: JSON.stringify({ \"email\": \"admin@email.com\",\"password\": \"adminpassword\" })\r",
1466 	                    "    }\r",
1467 	                    "}, (err, res) => {\r",
1468 	                    "    pm.variables.set(\"AUTH_TOKEN\", res?.json()?.token);\r",
1469 	                    "})"
1470 	                ]
1471 	            }
1472 	        },
1473 	        {
1474 	            "listen": "test",
1475 	            "script": {
1476 	                "type": "text/javascript",
1477 	                "packages": {},
1478 	                "exec": [
1479 	                    ""
1480 	                ]
1481 	            }
1482 	        }
1483 	    ],
1484 	    "variable": [
1485 	        {
1486 	            "key": "AUTH_TOKEN",
1487 	            "value": "",
1488 	            "type": "string"
1489 	        }
1490 	    ]
1491 	}
 
ДОДАТОК Д
ПРОГРАМНИЙ КОД

Д.1 Приклад перевірки токена авторизації

1 	const authenticateToken = (req, res, next) => {
2 	    const token = req.header('Authorization')?.split(' ')[1];
3 	
4 	    if (!token) return res.status(401).json({ error: 'Access denied' });
5 	
6 	    try {
7 	        const verified = jwt.verify(token, process.env.JWT_SECRET);
8 	        req.user = verified;
9 	        next();
10 	    } catch (err) {
11 	        res.status(403).json({ error: 'Invalid token' });
12 	    }
13 	};

Д.2 Приклад валідації даних продукту 

1 	const validateProduct = (req, res, next) => {
2 	    const { name, description, brand, size, type, price, quantity } = req.body;
3 	    if (!name) return res.status(400).json({ message: 'Name is required' });
4 	    if (!description) return res.status(400).json({ message: 'Description is required' });
5 	    if (!brand) return res.status(400).json({ message: 'Brand is required' });
6 	    if (!size) return res.status(400).json({ message: 'Size is required' });
7 	    if (!type) return res.status(400).json({ message: 'Type is required' });
8 	    if (!price) return res.status(400).json({ message: 'Price is required' });
9 	    if (!quantity) return res.status(400).json({ message: 'Quantity is required' });
10 	    next();
11 	}; 

Д.3 Приклад видалення користувача з бази даних 

1 	router.delete('/:id', async (req, res) => {
2 	    try {
3 	        const user = await User.findById(req.user.id);
4 	        if (!user) return res.status(404).json({ message: 'User not found' });
5 	
6 	        await User.deleteOne({ _id: req.user.id });
7 	        res.json({ message: 'User deleted' });
8 	    } catch (error) {
9 	        res.status(500).json({ message: error.message });
10 	    }
11 	});

Д.4 Приклад реєстрації та авторизації користувача

1 	router.post('/register', validateRegister, async (req, res) => {
2 	    const { role, name, email, password } = req.body;
3 	    const hashedPassword = await bcrypt.hash(password, 10);
4 	    const user = new User({ role, name, email, password: hashedPassword });
5 	
6 	    try {
7 	        const savedUser = await user.save();
8 	        res.status(201).json(savedUser);
9 	    } catch (error) {
10 	        res.status(400).json({ message: error.message });
11 	    }
12 	});
13 	
14 	router.post('/login', validateLogin, async (req, res) => {
15 	    const { email, password } = req.body;
16 	
17 	    try {
18 	        const user = await User.findOne({ email });
19 	        if (!user) return res.status(404).json({ message: 'User not found' });
20 	
21 	        const isMatch = await bcrypt.compare(password, user.password);
22 	        if (!isMatch) return res.status(400).json({ message: 'Invalid credentials' });
23 	
24 	        const token = jwt.sign({ id: user._id }, process.env.JWT_SECRET, { expiresIn: '1d' });
25 	        res.json({ token });
26 	    } catch (error) {
27 	        res.status(500).json({ message: error.message });
28 	    }
29 	});
 

ДОДАТОК Е
ВІДЕО НА ЮТУБ

https://youtu.be/bmBNNmzT9P8

